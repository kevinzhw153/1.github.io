<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title> 网络测速 </title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="Generator" content="EditPlus">
		<meta name="Author" content="xinmingyang">
		<meta name="Keywords" content="">
		<meta name="Description" content="">
	</head>
 
	<body>
		<!--<div>
			单位换算：宽带512kbps=64kb/s - 1M=128kb/s - 2M=256kb/s
		</div>-->
		<div id="box"></div>
	</body>
	
	<script>
		setInterval("getSpeed()", 1000);
		
		function getSpeed(){
			var startTime = new Date().getTime();
			var img = new Image();
			img.src = "http://127.0.0.1:80/web/resources/img/bandwidth.jpg?timeStamp=" + startTime;
			img.onload = function(){
				// 图片大小
				var size = 204.94 * 1000;
				var endTime = new Date().getTime();
				var speed = parseInt(size / (endTime - startTime));
				var unit = "KB/S";
				if(speed >= 1024){
					speed = (speed / 1024).toFixed(2);
					unit = "MB/S";
				}
				document.getElementById("box").innerHTML = "当前带宽："+ speed + unit + "<br/>请求用时：" + (endTime - startTime) / 1000 + "s";
			};
		}
	</script>
</html>

